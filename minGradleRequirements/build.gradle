/*defaultTasks 'doFinished'

//println ">>> build.gradle --> This is executed during the configuration phase  - timestamp @ ${gradle.timestamp()}"



task doStartProcess {
	doLast{
		println "$name - Now starting the process - OK!"
	}
}

task doStep2{
	doLast{
		println "$name - Performed OK!"
	}
}

task doSomethingInTheMiddle (dependsOn: ['doStartProcess',  tasks.findAll { task -> task.name.startsWith('doStep2')  }  ]) {
	doLast{
		println "$name - Performed the middle step - OK!"
	}
}


task doFinished (dependsOn: ['doSomethingInTheMiddle', 'doStep2'])   {
	doLast{
		println "$name - Done - OK!"
	}	
}




*/
project.gradle.taskGraph.whenReady {
	println">>> $project.gradle.taskGraph.allTasks"
}





defaultTasks 'doFinished'

//println ">>> build.gradle --> This is executed during the configuration phase  - timestamp @ ${gradle.timestamp()}"



task doStartProcess {
	doLast{
		println "$name - Now starting the process - OK!"
	}
}

task doStep2{
	doLast{
		println "$name - Performed OK!"
	}
}

task doSomethingInTheMiddle (dependsOn: ['doStartProcess',  tasks.findAll { task -> task.name.startsWith('doStep2')  }  ]) {
	doLast{
		println "$name - Performed the middle step - OK!"
	}
}


task doFinished {
	doLast{
		println "$name - Done - OK! >>> with version=$version"
	}	
}



//Conditional logic
if ( Math.random() < 0.5){
	doFinished.dependsOn doSomethingInTheMiddle, doStep2
}

project.gradle.taskGraph.whenReady {taskGraph ->
    if (taskGraph.hasTask(doStep2)) {    	
        project.version = '1.0'        
    } else {    	
        project.version = '1.0-SNAPSHOT'
    }
    println ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> $project.version"
}

 project.gradle.taskGraph.beforeTask{task ->
  	println "+++ Before task $task.name"
 }
 
 project.gradle.taskGraph.afterTask{task ->
  	println "+++ Finished task $task.name"
 }


